<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Visual Schedule & Timer</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js (Mandatory for Analytics) -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Jua&family=Noto+Sans+KR:wght@400;700;900&display=swap" rel="stylesheet">
    
    <style>
        /* Chosen Palette: Soft Warm Neutrals with High Contrast Accents */
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #F8FAFC;
            color: #334155;
            overflow: hidden; /* Prevent scrolling in main view */
        }
        .font-jua {
            font-family: 'Jua', sans-serif;
        }
        
        /* Smooth Transitions */
        .timer-bar-transition {
            transition: width 1s linear, background-color 1s ease;
        }
        .slide-up {
            animation: slideUp 0.5s ease-out;
        }
        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        /* Chart Container Styling (Mandatory) */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 500px;
            height: 300px;
            max-height: 300px;
            margin: 0 auto;
        }

        /* Custom Scrollbar for Dashboard & Timeline */
        .custom-scroll::-webkit-scrollbar {
            width: 8px;
            height: 8px; /* For horizontal scroll */
        }
        .custom-scroll::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        .custom-scroll::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }
        
        /* Timeline specific adjustments */
        #timeline-bar {
            scroll-behavior: smooth;
        }
    </style>
</head>
<body class="h-screen flex flex-col">

    <!-- 1. Header -->
    <header class="h-16 bg-white border-b border-slate-200 flex justify-between items-center px-6 shrink-0 z-20 shadow-sm relative">
        <div class="flex items-center gap-2">
            <span class="text-2xl">ğŸ•’</span>
            <h1 class="text-xl font-bold text-slate-700 tracking-tight">ë³´ì´ëŠ” ì‹œê°„í‘œ <span class="text-sm font-normal text-slate-400">| Visual Schedule</span></h1>
        </div>
        <div class="flex gap-3">
            <button onclick="toggleFullScreen()" class="hidden md:flex items-center gap-2 px-4 py-2 bg-slate-100 hover:bg-slate-200 rounded-lg text-slate-600 font-bold transition text-sm">
                <span>â›¶</span> ì „ì²´í™”ë©´
            </button>
            <button onclick="toggleDashboard()" class="flex items-center gap-2 px-4 py-2 bg-slate-800 hover:bg-slate-700 text-white rounded-lg font-bold transition text-sm shadow-md">
                <span>âš™ï¸</span> ëŒ€ì‹œë³´ë“œ
            </button>
        </div>
    </header>

    <!-- [NEW] 1.5 Timeline Section -->
    <nav id="timeline-bar" class="w-full bg-slate-50 border-b border-slate-200 h-24 flex items-center gap-3 px-4 overflow-x-auto shrink-0 custom-scroll z-10 shadow-inner">
        <!-- Javascript renders cards here -->
    </nav>

    <!-- 2. Main Visual Interface -->
    <main class="flex-1 flex flex-col md:flex-row relative overflow-hidden">
        
        <!-- SECTION: NOW (Current Activity) -->
        <section class="flex-[2] md:flex-[3] bg-white flex flex-col justify-center items-center p-4 md:p-8 relative border-b md:border-b-0 md:border-r border-slate-200 z-10">
            <!-- Badge -->
            <div class="absolute top-4 left-4 md:top-8 md:left-8 bg-emerald-100 text-emerald-700 px-6 py-2 rounded-full font-jua text-xl md:text-2xl shadow-sm border border-emerald-200 animate-pulse">
                ì§€ê¸ˆ í•´ìš” (NOW)
            </div>

            <!-- Content Wrapper -->
            <div class="flex flex-col items-center w-full max-w-4xl slide-up">
                <!-- Icon -->
                <div id="now-icon" class="text-[120px] md:text-[200px] mb-2 md:mb-6 filter drop-shadow-xl transition-transform hover:scale-105 cursor-pointer" onclick="toggleTimer()">
                    ğŸ‘‹
                </div>
                
                <!-- Title -->
                <h2 id="now-title" class="text-5xl md:text-7xl font-black text-slate-800 mb-8 md:mb-12 font-jua text-center leading-tight">
                    ì•„ì¹¨ ì¸ì‚¬
                </h2>

                <!-- VISUAL TIMER BAR -->
                <div class="w-full bg-slate-100 rounded-full h-12 md:h-20 shadow-inner border border-slate-300 relative overflow-hidden mb-4">
                    <!-- The Bar -->
                    <div id="timer-bar" class="timer-bar-transition h-full w-full bg-emerald-500 origin-left"></div>
                    <!-- Stripes Overlay for texture -->
                    <div class="absolute inset-0 opacity-10" style="background-image: linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent); background-size: 1rem 1rem;"></div>
                    <!-- Time Text (Optional) -->
                    <div class="absolute inset-0 flex items-center justify-center">
                        <span id="timer-text" class="text-xl md:text-3xl font-mono font-bold text-slate-600/50 mix-blend-multiply">05:00</span>
                    </div>
                </div>
                
                <p id="timer-status" class="text-slate-400 font-medium text-lg">ì‹œì‘í•˜ë ¤ë©´ ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš”</p>
            </div>

            <!-- Floating Controls -->
            <div class="absolute bottom-6 md:bottom-10 flex gap-4 md:gap-6">
                <button id="btn-control" onclick="toggleTimer()" class="w-20 h-20 rounded-full bg-emerald-500 hover:bg-emerald-600 text-white text-4xl shadow-xl flex items-center justify-center transition transform active:scale-95">
                    â–¶
                </button>
                <button onclick="resetCurrentActivity()" class="w-20 h-20 rounded-full bg-slate-200 hover:bg-slate-300 text-slate-500 text-3xl shadow-lg flex items-center justify-center transition transform active:scale-95">
                    â†º
                </button>
                <button onclick="nextActivity()" class="h-20 px-8 rounded-full bg-indigo-600 hover:bg-indigo-700 text-white text-xl font-jua shadow-xl flex items-center justify-center gap-2 transition transform active:scale-95">
                    ë‹¤ìŒ í™œë™ <span class="text-2xl">â”</span>
                </button>
            </div>
        </section>

        <!-- SECTION: NEXT (Next Activity) -->
        <section class="flex-1 bg-slate-50 flex flex-col justify-center items-center p-4 border-l border-slate-200 relative opacity-90">
            <div class="absolute top-4 left-4 bg-indigo-100 text-indigo-700 px-4 py-1 rounded-full font-jua text-lg shadow-sm border border-indigo-200">
                ë‹¤ìŒì— í•´ìš” (NEXT)
            </div>

            <div class="text-center slide-up">
                <div id="next-icon" class="text-[80px] md:text-[120px] mb-4 opacity-70 grayscale-[30%]">
                    ğŸ“š
                </div>
                <h3 id="next-title" class="text-3xl md:text-4xl font-bold text-slate-600 font-jua mb-4">
                    êµ­ì–´ ìˆ˜ì—…
                </h3>
                <div class="inline-block px-4 py-2 bg-white rounded-lg border border-slate-200 text-slate-400 text-sm font-bold shadow-sm">
                    <span id="next-duration">20</span>ë¶„ ì˜ˆì •
                </div>
            </div>
        </section>

    </main>

    <!-- 3. Dashboard Modal (Overlay) -->
    <div id="dashboard-modal" class="fixed inset-0 bg-black/60 backdrop-blur-sm z-50 hidden flex justify-end transition-opacity duration-300">
        <div class="w-full md:w-[500px] bg-white h-full shadow-2xl flex flex-col slide-up">
            
            <!-- Modal Header -->
            <div class="p-6 border-b border-slate-100 flex justify-between items-center bg-slate-50">
                <h2 class="text-2xl font-bold text-slate-800">âš™ï¸ ì„ ìƒë‹˜ ëŒ€ì‹œë³´ë“œ</h2>
                <button onclick="toggleDashboard()" class="text-slate-400 hover:text-slate-600 text-3xl">&times;</button>
            </div>

            <!-- Content Area -->
            <div class="flex-1 overflow-y-auto custom-scroll p-6 space-y-8">
                
                <!-- Analytics Section -->
                <div class="bg-white rounded-2xl p-4 border border-slate-200 shadow-sm">
                    <h3 class="text-sm font-bold text-slate-500 uppercase tracking-wider mb-4 border-l-4 border-indigo-500 pl-2">
                        ì¼ê³¼ ì‹œê°„ ë¶„ì„ (Time Distribution)
                    </h3>
                    <p class="text-xs text-slate-400 mb-2">ì˜¤ëŠ˜ ì„¤ì •ëœ í™œë™ë“¤ì˜ ì‹œê°„ ë°°ë¶„ ë¹„ìœ¨ì…ë‹ˆë‹¤.</p>
                    
                    <!-- Chart.js Canvas Container -->
                    <div class="chart-container">
                        <canvas id="timeDistChart"></canvas>
                    </div>
                </div>

                <!-- Schedule Editor Section -->
                <div>
                    <div class="flex justify-between items-end mb-4">
                        <h3 class="text-sm font-bold text-slate-500 uppercase tracking-wider border-l-4 border-emerald-500 pl-2">
                            ì¼ê³¼ ìˆœì„œ ê´€ë¦¬
                        </h3>
                        <button onclick="resetToDefault()" class="text-xs text-slate-400 hover:text-red-400 underline">ê¸°ë³¸ê°’ ì´ˆê¸°í™”</button>
                    </div>
                    
                    <div id="schedule-editor-list" class="space-y-3">
                        <!-- List Items Injected Here -->
                    </div>

                    <button onclick="addNewItem()" class="w-full mt-4 py-3 border-2 border-dashed border-slate-300 rounded-xl text-slate-500 font-bold hover:bg-slate-50 hover:border-slate-400 transition flex items-center justify-center gap-2">
                        <span>â•</span> ìƒˆ í™œë™ ì¶”ê°€
                    </button>
                </div>
                
                <!-- Quick Presets -->
                <div>
                     <h3 class="text-sm font-bold text-slate-500 uppercase tracking-wider mb-3">ìì£¼ ì“°ëŠ” ì¹´ë“œ</h3>
                     <div class="grid grid-cols-4 gap-2">
                         <button onclick="quickAdd('í™”ì¥ì‹¤', 'ğŸš½', 5)" class="p-2 bg-slate-50 hover:bg-slate-100 rounded border text-2xl" title="í™”ì¥ì‹¤">ğŸš½</button>
                         <button onclick="quickAdd('ì†ì”»ê¸°', 'ğŸ§¼', 3)" class="p-2 bg-slate-50 hover:bg-slate-100 rounded border text-2xl" title="ì†ì”»ê¸°">ğŸ§¼</button>
                         <button onclick="quickAdd('ê°„ì‹', 'ğŸ©', 15)" class="p-2 bg-slate-50 hover:bg-slate-100 rounded border text-2xl" title="ê°„ì‹">ğŸ©</button>
                         <button onclick="quickAdd('ì´ë™', 'ğŸšŒ', 10)" class="p-2 bg-slate-50 hover:bg-slate-100 rounded border text-2xl" title="ì´ë™">ğŸšŒ</button>
                     </div>
                </div>

            </div>

            <!-- Modal Footer -->
            <div class="p-4 border-t border-slate-100 bg-slate-50">
                <button onclick="toggleDashboard()" class="w-full bg-slate-800 text-white py-3 rounded-xl font-bold shadow-lg hover:bg-slate-700 transition">
                    ì„¤ì • ì™„ë£Œ (ë‹«ê¸°)
                </button>
            </div>
        </div>
    </div>

    <script>
        // --- 1. Initial Data ---
        const defaultSchedule = [
            { id: 1, name: "ì•„ì¹¨ ì¸ì‚¬", icon: "ğŸ‘‹", duration: 5, category: "ìƒí™œ" },
            { id: 2, name: "êµ­ì–´ ìˆ˜ì—…", icon: "ğŸ“š", duration: 20, category: "í•™ìŠµ" },
            { id: 3, name: "ì‰¬ëŠ” ì‹œê°„", icon: "ğŸˆ", duration: 10, category: "ë†€ì´" },
            { id: 4, name: "ë¯¸ìˆ  í™œë™", icon: "ğŸ¨", duration: 30, category: "í•™ìŠµ" },
            { id: 5, name: "ì ì‹¬ ì‹ì‚¬", icon: "ğŸ±", duration: 40, category: "ìƒí™œ" },
            { id: 6, name: "ì •ë¦¬ ì •ëˆ", icon: "ğŸ§¹", duration: 5, category: "ìƒí™œ" },
            { id: 7, name: "í•˜êµ í•˜ê¸°", icon: "ğŸ ", duration: 0, category: "ìƒí™œ" }
        ];

        // --- 2. State Management ---
        let schedule = JSON.parse(JSON.stringify(defaultSchedule)); // Deep copy
        let currentIndex = 0;
        let timeLeft = 0; // seconds
        let totalTime = 0; // seconds
        let timerInterval = null;
        let isRunning = false;
        let chartInstance = null;

        // --- 3. DOM Elements ---
        const els = {
            nowTitle: document.getElementById('now-title'),
            nowIcon: document.getElementById('now-icon'),
            nextTitle: document.getElementById('next-title'),
            nextIcon: document.getElementById('next-icon'),
            nextDuration: document.getElementById('next-duration'),
            timerBar: document.getElementById('timer-bar'),
            timerText: document.getElementById('timer-text'),
            timerStatus: document.getElementById('timer-status'),
            btnControl: document.getElementById('btn-control'),
            dashboard: document.getElementById('dashboard-modal'),
            editorList: document.getElementById('schedule-editor-list'),
            timeline: document.getElementById('timeline-bar') // [NEW] Timeline Element
        };

        // --- 4. Core Logic: Activity & Timer ---
        function loadActivity(index) {
            // Boundary Check
            if (index >= schedule.length) {
                renderEndScreen();
                return;
            }

            currentIndex = index;
            const current = schedule[currentIndex];
            const next = schedule[currentIndex + 1] || { name: "ì¼ê³¼ ì¢…ë£Œ", icon: "ğŸ", duration: 0 };

            // Render UI
            els.nowTitle.textContent = current.name;
            els.nowIcon.textContent = current.icon;
            els.nextTitle.textContent = next.name;
            els.nextIcon.textContent = next.icon;
            els.nextDuration.textContent = next.duration;

            // Reset Timer logic
            stopTimer();
            totalTime = current.duration * 60;
            timeLeft = totalTime;
            
            // Initial Visual Reset
            els.timerBar.style.width = '100%';
            els.timerBar.className = 'timer-bar-transition h-full w-full bg-emerald-500 origin-left';
            els.timerStatus.textContent = "ì‹œì‘í•˜ë ¤ë©´ ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš”";
            updateTimerText();

            // Special case for 0 min activities (e.g. Go Home)
            if (totalTime === 0) {
                els.timerStatus.textContent = "ì¢…ë£Œ í™œë™ì…ë‹ˆë‹¤.";
                els.timerBar.style.width = '0%';
                els.timerText.textContent = "";
            }

            // Update Timeline Highlight
            renderTimeline();
        }

        // [NEW] Render Horizontal Timeline
        function renderTimeline() {
            els.timeline.innerHTML = ''; // Clear

            schedule.forEach((item, index) => {
                const isPast = index < currentIndex;
                const isCurrent = index === currentIndex;
                
                const btn = document.createElement('button');
                
                // Styles based on state
                let baseClass = "flex-shrink-0 flex flex-col items-center justify-center w-16 h-16 rounded-xl border transition-all duration-300 snap-start ";
                let stateClass = "";

                if (isCurrent) {
                    stateClass = "bg-indigo-600 border-indigo-600 text-white shadow-lg scale-105 ring-2 ring-indigo-200 z-10";
                } else if (isPast) {
                    stateClass = "bg-slate-100 border-slate-200 text-slate-300 grayscale opacity-70";
                } else {
                    stateClass = "bg-white border-slate-200 text-slate-500 hover:bg-slate-50 hover:border-indigo-300";
                }
                
                btn.className = baseClass + stateClass;
                btn.onclick = () => loadActivity(index); // Jump to activity

                btn.innerHTML = `
                    <span class="text-2xl mb-1">${item.icon}</span>
                    <span class="text-[10px] font-bold truncate w-full text-center leading-none">${item.name}</span>
                `;
                els.timeline.appendChild(btn);
            });

            // Auto-scroll to center current item
            if (schedule[currentIndex]) {
                const activeEl = els.timeline.children[currentIndex];
                if (activeEl) {
                    setTimeout(() => {
                        activeEl.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
                    }, 100);
                }
            }
        }

        function updateTimerVisuals() {
            if (totalTime === 0) return;

            const percentage = (timeLeft / totalTime) * 100;
            els.timerBar.style.width = `${percentage}%`;

            // Color Logic: Green -> Yellow -> Red
            let colorClass = 'bg-emerald-500';
            if (percentage <= 20) colorClass = 'bg-red-500';
            else if (percentage <= 50) colorClass = 'bg-amber-400';
            
            els.timerBar.className = `timer-bar-transition h-full w-full ${colorClass} origin-left`;
            updateTimerText();
        }

        function updateTimerText() {
            const m = Math.floor(timeLeft / 60);
            const s = timeLeft % 60;
            els.timerText.textContent = `${String(m).padStart(2, '0')}:${String(s).padStart(2, '0')}`;
        }

        function toggleTimer() {
            if (totalTime === 0) return;

            if (isRunning) {
                stopTimer();
                els.timerStatus.textContent = "ì¼ì‹œ ì •ì§€ë¨";
            } else {
                startTimer();
                els.timerStatus.textContent = "í™œë™ ì§„í–‰ ì¤‘...";
            }
        }

        function startTimer() {
            if (timeLeft <= 0) return;
            isRunning = true;
            els.btnControl.textContent = "âšâš"; // Pause icon
            els.btnControl.classList.remove('bg-emerald-500');
            els.btnControl.classList.add('bg-slate-700');

            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimerVisuals();

                if (timeLeft <= 0) {
                    stopTimer();
                    els.timerStatus.textContent = "ì‹œê°„ ì¢…ë£Œ! ë‹¤ìŒ í™œë™ìœ¼ë¡œ ë„˜ì–´ê°€ì„¸ìš”.";
                    els.timerBar.classList.add('animate-pulse'); // Visual cue
                }
            }, 1000);
        }

        function stopTimer() {
            isRunning = false;
            clearInterval(timerInterval);
            els.btnControl.textContent = "â–¶";
            els.btnControl.classList.remove('bg-slate-700');
            els.btnControl.classList.add('bg-emerald-500');
            els.timerBar.classList.remove('animate-pulse');
        }

        function resetCurrentActivity() {
            stopTimer();
            timeLeft = totalTime;
            updateTimerVisuals();
            els.timerStatus.textContent = "ì‹œê°„ì´ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.";
        }

        function nextActivity() {
            loadActivity(currentIndex + 1);
        }

        function renderEndScreen() {
            els.nowTitle.textContent = "ëª¨ë“  ì¼ê³¼ ë!";
            els.nowIcon.textContent = "ğŸ‰";
            els.timerText.textContent = "";
            els.timerBar.style.width = "0%";
            els.timerStatus.textContent = "ì°¸ ì˜í–ˆì–´ìš”!";
            
            els.nextTitle.textContent = "-";
            els.nextIcon.textContent = "";
            stopTimer();
            renderTimeline(); // Update timeline
        }

        // --- 5. Dashboard & Analytics Logic ---

        function toggleDashboard() {
            const isHidden = els.dashboard.classList.contains('hidden');
            if (isHidden) {
                els.dashboard.classList.remove('hidden');
                renderEditor();
                renderChart();
            } else {
                els.dashboard.classList.add('hidden');
                loadActivity(currentIndex); 
            }
        }

        function renderEditor() {
            els.editorList.innerHTML = '';
            schedule.forEach((item, index) => {
                const isActive = index === currentIndex ? "border-emerald-500 ring-1 ring-emerald-500" : "border-slate-200";
                
                const div = document.createElement('div');
                div.className = `flex items-center gap-2 p-3 bg-white rounded-xl border ${isActive} shadow-sm`;
                div.innerHTML = `
                    <div class="text-2xl w-10 text-center cursor-pointer hover:bg-slate-100 rounded" onclick="changeIcon(${index})">${item.icon}</div>
                    <div class="flex-1">
                        <input type="text" value="${item.name}" onchange="updateSchedule(${index}, 'name', this.value)" class="w-full font-bold text-slate-700 text-sm outline-none border-b border-transparent focus:border-indigo-300 transition">
                    </div>
                    <div class="flex items-center gap-1">
                        <input type="number" value="${item.duration}" onchange="updateSchedule(${index}, 'duration', this.value)" class="w-12 text-center bg-slate-50 border rounded text-sm p-1 outline-none focus:ring-1 focus:ring-indigo-500">
                        <span class="text-xs text-slate-400">ë¶„</span>
                    </div>
                    <button onclick="deleteScheduleItem(${index})" class="text-slate-300 hover:text-red-500 px-2 transition">ğŸ—‘ï¸</button>
                `;
                els.editorList.appendChild(div);
            });
        }

        function updateSchedule(index, key, value) {
            if (key === 'duration') value = parseInt(value) || 0;
            schedule[index][key] = value;
            if (key === 'duration') renderChart(); 
            renderTimeline(); // Update timeline on name change
        }

        function deleteScheduleItem(index) {
            schedule.splice(index, 1);
            if (index < currentIndex) currentIndex--;
            renderEditor();
            renderChart();
            renderTimeline();
        }

        function addNewItem() {
            schedule.push({ id: Date.now(), name: "ìƒˆ í™œë™", icon: "âœ¨", duration: 15, category: "ê¸°íƒ€" });
            renderEditor();
            renderChart();
            renderTimeline();
        }

        function quickAdd(name, icon, duration) {
            schedule.push({ id: Date.now(), name: name, icon: icon, duration: duration, category: "ìƒí™œ" });
            renderEditor();
            renderChart();
            renderTimeline();
        }

        function resetToDefault() {
            if(confirm("ì¼ê³¼ë¥¼ ì´ˆê¸° ìƒíƒœë¡œ ë˜ëŒë¦¬ì‹œê² ìŠµë‹ˆê¹Œ?")) {
                schedule = JSON.parse(JSON.stringify(defaultSchedule));
                currentIndex = 0;
                renderEditor();
                renderChart();
                loadActivity(0);
            }
        }

        // --- Chart.js Implementation (Mandatory) ---
        function renderChart() {
            const ctx = document.getElementById('timeDistChart').getContext('2d');
            
            // Aggregate Data
            const categories = {};
            schedule.forEach(item => {
                const cat = item.category || "ê¸°íƒ€";
                categories[cat] = (categories[cat] || 0) + item.duration;
            });

            const labels = Object.keys(categories);
            const data = Object.values(categories);

            // Destroy existing chart to prevent overlay
            if (chartInstance) chartInstance.destroy();

            chartInstance = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: labels,
                    datasets: [{
                        data: data,
                        backgroundColor: [
                            'rgba(16, 185, 129, 0.6)', // Emerald (Life)
                            'rgba(99, 102, 241, 0.6)', // Indigo (Study)
                            'rgba(245, 158, 11, 0.6)', // Amber (Play)
                            'rgba(148, 163, 184, 0.6)' // Slate (Other)
                        ],
                        borderColor: [
                            'rgb(16, 185, 129)',
                            'rgb(99, 102, 241)',
                            'rgb(245, 158, 11)',
                            'rgb(148, 163, 184)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return ` ${context.label}: ${context.raw}ë¶„`;
                                }
                            }
                        }
                    }
                }
            });
        }

        function toggleFullScreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                }
            }
        }

        // --- Initialization ---
        window.addEventListener('DOMContentLoaded', () => {
            loadActivity(0);
        });

    </script>
</body>
</html>
